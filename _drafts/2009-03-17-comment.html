---
layout: post
title: Solr Search Engine on Ubuntu
date: '2009-03-17T12:38:00.000-07:00'
author: Larry Reid
tags:
- Ubuntu
- Search
modified_time: '2009-03-22T21:09:13.675-07:00'
blogger_id: tag:blogger.com,1999:blog-5778824359157275227.post-1170874466744211544
blogger_orig_url: https://www.blogger.com/comment.g?blogID=5778824359157275227&postID=1170874466744211544
---

<font style="font-style: italic;">If all you want to do is use Solr from a Rails application, then look <a href="http://technopragmatica.blogspot.com/2009/03/solr-and-rails.html">here</a>.</font> If you want a general purpose Solr server, read on.<br /><br />I wanted to index Word, PDF, Excel and other types of files. What I really wanted to do was build a "Google-like" search site, that indexes all types of files on file shares. I know Google has a search service, but that would require putting data into their servers. Many of my clients are healthcare providers, sending data to the States doesn't fly with them.<br /><br />I chose to use <a href="http://lucene.apache.org/solr/">Solr</a>, because it has a pretty impressive list of websites already using it, and it's an Apache project.<br /><br />To index Word, PDF and Excel, I had to get a <a href="http://people.apache.org/builds/lucene/solr/nightly/">nightly build of Solr</a>, because searching the body of such document types will only be available in Solr 1.4, and Solr is currently at 1.3. The ability to index document types like Word, PDF and Excel is in a part of Solr called Solr Cell, which uses another Apache project called Tika. The nightly build includes the Tika project's code, so you don't have to download or build Tika separately.<br /><br />You can run the examples from the Solr wiki in the nightly build just like you would for the released version.<br /><br />Once I had everything built, I followed the <a href="http://wiki.apache.org/solr/ExtractingRequestHandler#head-cd3da9e034dc18328b67240330d749c9f097897a">instructions</a> for Solr Cell. I found that the <a href="http://wiki.apache.org/solr/ExtractingRequestHandler#head-c95841f9eda007b6b4e4594ead12a04223cf7b6e">code they tell you to add</a> to "example/solr/conf/solrconfig.xml" caused a Java error and the web application wouldn't start.<br /><br />Lesson Three: I noticed that further up the solrconfig.xml file in the nightly build version there was code for the same handler in comments. I removed the offending code and uncommented what was already in the file and the web application would start.<br /><br />Finally, I'm ready to load some documents into the index. Unfortunately, the examples didn't work for me. The Solr server said that ID is a required field. The solution is this: The XML examples don't need a document ID to be specified, because they pull it from the XML. The Solr Cell examples need an ID specified, so you have to add to the example from the wiki: ext.literal.id=1 (or whatever number you want to give).<pre>curl http://localhost:8983/solr/update/extract?ext.idx.attr=true\&amp;ext.def.fl=text\&amp;ext.literal.id=1 -F "myfile=@tutorial.html"</pre>Other lessons learned from my flailing follow. No need for you to repeat them. I document them here so I don't forget all blind alleys I went down:<br /><br />I installed the Solr search engine on Ubuntu 8.10 from Synaptic. Lesson one: Don't use the Ubuntu packages from Synaptic. Normally I prefer to do things "by the Ubuntu book", but I tried the packages and I couldn't get to the Solr admin page. In less time than it took me to eat a piece of pizza, I downloaded and installed a nightly build tar file from the <a href="http://lucene.apache.org/solr/">Solr site</a>.<br /><br />That requires the "Solr Cell" project, aka the ExtractingRequestHandler. Solr Cell requires the <a href="http://incubator.apache.org/tika/">Apache Tika</a> project, which requires Solr >1.3, which means I had to get a <a href="http://people.apache.org/builds/lucene/solr/nightly/">nightly build of Solr</a>.<br /><br />Lesson two: By taking the nightly build, I have all the files in the right place. I lost some time taking the source tree, but how to build from source isn't immediately obvious to me (a non-Java person). The nightly build has everything pretty much the way the <a href="http://lucene.apache.org/solr/tutorial.html#Getting+Started">Solr tutorial</a> describes it, so you can get the nightly build running as easily as the released version.<br /><br /><br />